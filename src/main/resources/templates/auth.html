<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">
    </script>
      	<meta charset="UTF-8"></meta>
      	<title>Hello World</title>
</head>
<body>
  	<p th:text="${hello}" id="jwt22"></p>
<textarea id="jwt" th:text="${jwt}"  cols="120" rows="6"></textarea>
<br><br>
<span id="token" th:text="${token}"></span>
<br>
<button onclick="directCall()">Direct Call</button> &nbsp &nbsp &nbsp
<button onclick="proxiedCall()">Proxied Call</button>

<script>
function directCall() {
	var jwt =document.getElementById("jwt").value;
console.log("jwt = " + jwt);
    $.ajax({
        //this is a 'cross-origin' domain
        //url : "https://localhost:8443/api/test-a",
        url : "http://localhost:8080/api/time",
       // dataType : 'json',
        //data : { "handler" : "statistic"
        //},
        headers: {
            "x-key": "123",
            "Authorization": "bearer " + jwt,
            "Access-Control-Allow-Origin": "*"
       //     "Access-Control-Request-Headers": "x-requested-with"
          },
        success : function(data) {
            alert(data);
        },
        error : function(jqXHR, textStatus, errorThrown) {
            alert("error");
        }
    });
}

function proxiedCall() {
    //var jwt =document.getElementById("jwt").innerText;
	var jwt =document.getElementById("jwt").value;

    $.ajax({
        //this is a 'cross-origin' domain
        url : "https://localhost:8443/api/proxy/time",
         //       url : "http://192.168.254.35:8080/api/add",
       // dataType : 'json',
        //data : { "handler" : "statistic"
        //},
        headers: {
            "Authorization": "bearer " + jwt,
            "Access-Control-Allow-Origin": "*"
       //     "Access-Control-Request-Headers": "x-requested-with"
          },
        success : function(data) {
            alert(data);
        },
        error : function(jqXHR, textStatus, errorThrown) {
            alert("error");
        }
    });
}
/*
function getToken() {
    var cookie = Cookie.getCookie(cookieName);
    var auth = jQuery.parseJSON(cookie);
    var token = "Token " + auth.id + ":" + auth.key;
}
*/

	function myFunction() {
	  var a=document.getElementById("jwt").innerText;
	  alert(a);
	}
	</script>

</body>
</html>